{% extends "songs/base.html" %}

{% block style %}
.slidecontainer {
  width: 25%;
}

.slider {
  -webkit-appearance: none;
  width: 100%;
  height: 25px;
  background: #d3d3d3;
  outline: none;
  opacity: 0.7;
  -webkit-transition: .2s;
  transition: opacity .2s;
}

.slider:hover {
  opacity: 1;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 25px;
  height: 25px;
  background: #04AA6D;
  cursor: pointer;
}

.slider::-moz-range-thumb {
  width: 25px;
  height: 25px;
  background: #04AA6D;
  cursor: pointer;
}
{% endblock %}

{% block script_start %}
window.setTimeout(function() {
    if (!document.hidden && document.hasFocus()) {
        window.location.reload();
    } else {
        window.addEventListener("focus", function() {
            window.location.reload();
        });
    }
}, 5000);
{% endblock %}

{% block title %}Queue{% endblock %}
{% block headerTitle %}Queue{% endblock %}

{% block content %}

<p>Paused: {{ paused }}</p>

<p>Auto Related Next: {{ improvised }} | <a href="{% url 'songs:improvise_api' %}">Toggle</a></p>

<p><a href="{% url 'songs:improvise_now_api' %}">Add related song</a></p>

{% if paused %}
<a href="{% url 'songs:resume_api' %}">▶️ </a>
{% else %}
<a href="{% url 'songs:pause_api' %}">⏸️ </a>
{% endif %}
<a href="{% url 'songs:skip_api' %}">⏭️ </a>

<div class="slidecontainer">
    <input type="range" min="0" max="100" value="50" class="slider" id="myRange">
</div>


<p>Curently Playing: <a href="{% url 'songs:song' song_curr_id %}">{{ song_curr }}</a> [listened {{ song_curr_timed }}]</p>

{% for song in playlists %}
    <li><a href="{% url 'songs:song' song.id %}"> {{ song }} </a></li>
{% endfor %}
{% endblock %}

{% block script_end %}
var slider = document.getElementById("myRange");
slider.oninput = function() {
    const xhr = new XMLHttpRequest();
    const url_mask = "{% url 'songs:set_volume_api' 12345 %}".replace(/12345/, this.value.toString());
    xhr.open("GET", url_mask);
    xhr.send();
};
{% endblock %}
